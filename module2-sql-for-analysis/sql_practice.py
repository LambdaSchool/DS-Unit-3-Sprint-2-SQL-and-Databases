# SQL practice
# Michael Toce
import numpy as np
import pandas as pd

#-----------------------------------------------------------------------------------------------------------------------
# 1: LOAD IN CHINOOK_DB FROM SQLITE3
#-----------------------------------------------------------------------------------------------------------------------
import sqlite3
import os

# create database filepath to db file
DB_FILEPATH = os.path.join(os.path.dirname(__file__), "chinook.db")

# connect to db
lite_conn = sqlite3.connect(DB_FILEPATH)

# create cursor after connecting
lite_curs = lite_conn.cursor()

#-----------------------------------------------------------------------------------------------------------------------
# ANSWER THESE QUESTIONS USING SQL QUERIES
#-----------------------------------------------------------------------------------------------------------------------
# 1: HOW MANY TRACKS ON AVERAGE PER GENRE
# 2: HOW MANY TRACK NAMES LONGER THAN 20 CHARACTERS
# 3: AVERAGE UNIT PRICE PER ALBUM

#-----------------------------------------------------------------------------------------------------------------------
# 1: HOW MANY TRACKS PER GENRE
#-----------------------------------------------------------------------------------------------------------------------

tracks_per_genre = '''
SELECT
    tracks.GenreId,
    AVG(tracks.TrackId) as avg_tracks
from
    tracks
    left join genres on genres.GenreId = tracks.GenreId
group BY
    tracks.GenreId
'''



#-----------------------------------------------------------------------------------------------------------------------
# 2: HOW MANY TRACKS PER ALBUM PER GENRE
#-----------------------------------------------------------------------------------------------------------------------
#
#-----------------------------------------------------------------------------------------------------------------------
# 2: HOW MANY TRACK NAMES LONGER THAN 20 CHARACTERS
#-----------------------------------------------------------------------------------------------------------------------

#-----------------------------------------------------------------------------------------------------------------------
# 3: AVERAGE UNIT PRICE PER ALBUM
#-----------------------------------------------------------------------------------------------------------------------